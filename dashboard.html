<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Portal Dashboard</title>
    <link rel="stylesheet" href="assets/styles.css">
</head>
<body>
    <header>
        <h1>ðŸŽ® My Game Portal</h1>
    </header>
    <main>
        <input type="text" id="search" placeholder="Search games..." style="margin: 1em; padding: 0.5em; width: 60%; max-width: 400px;">
        <select id="category-filter" style="margin: 1em; padding: 0.5em;">
            <option value="">All Categories</option>
        </select>
        <section id="game-list">
            <!-- Games will be loaded here -->
        </section>
    </main>
    <script>
    let allGames = [];
    const list = document.getElementById('game-list');
    const search = document.getElementById('search');
    const categoryFilter = document.getElementById('category-filter');

    fetch('data/games.json')
      .then(response => response.json())
      .then(games => {
        allGames = games;
        // Populate category filter
        const categories = Array.from(new Set(games.map(g => g.category)));
        categories.forEach(cat => {
          const opt = document.createElement('option');
          opt.value = cat;
          opt.textContent = cat;
          categoryFilter.appendChild(opt);
        });
        renderGames();
      });

    // Always show all games on initial load, regardless of search/category
    function renderGames() {
      let filtered = allGames;
      const searchTerm = search.value.toLowerCase();
      const selectedCategory = categoryFilter.value;
      if (searchTerm || selectedCategory) {
        filtered = allGames.filter(game => {
          const matchesSearch =
            game.title.toLowerCase().includes(searchTerm) ||
            game.shortDescription.toLowerCase().includes(searchTerm) ||
            game.fullDescription.toLowerCase().includes(searchTerm);
          const matchesCategory = !selectedCategory || game.category === selectedCategory;
          return matchesSearch && matchesCategory;
        });
      }
      list.innerHTML = filtered.map(game => `
        <div class="game-card">
          <img src="${game.icon}" alt="${game.title} icon" class="game-icon">
          <h2>${game.title}</h2>
          <p>${game.shortDescription}</p>
          <p><strong>Category:</strong> ${game.category}</p>
          <p><strong>Plays:</strong> ${game.plays ?? '-'} | <strong>Rating:</strong> ${game.rating ?? '-'}</p>
          <a href="game_detail.html?id=${game.id}">View Details & Play</a>
        </div>
      `).join('');
    }

    search.addEventListener('input', renderGames);
    categoryFilter.addEventListener('change', renderGames);
    </script>
</body>
</html>
